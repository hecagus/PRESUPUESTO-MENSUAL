<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados – Uber Eats Tracker</title>

    <link rel="stylesheet" href="assets/css/style.css">
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script> 
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

<header class="header">
    <h1>Panel de Resultados</h1>
    <a href="admin.html" class="btn-admin">⚙ Ir al Administrador</a>
</header>

<main class="container">

    <section class="card">
        <h2>Resumen del Día</h2>

        <div class="stats-grid">
            <div class="stat">
                <label>Horas:</label>
                <span id="resHoras">0</span>
            </div>

            <div class="stat">
                <label>Ganancia Bruta:</label>
                <span id="resGananciaBruta">$0</span>
            </div>

            <div class="stat">
                <label>Gastos:</label>
                <span id="resGastos">$0</span>
            </div>

            <div class="stat">
                <label>Neta:</label>
                <span id="resNeta">$0</span>
            </div>
        </div>
    </section>
    
    <section class="card">
        <h2>Proyección Real</h2>

        <p>Basado en tus promedios y deudas.</p>

        <div class="projection"><label>Deuda total pendiente:</label> <span id="proyDeuda">$0</span></div>
        <div class="projection"><label>Promedio horas/día:</label> <span id="proyHoras">0 h</span></div>
        <div class="projection"><label>Promedio ganancia neta/día:</label> <span id="proyNeta">$0</span></div>
        <div class="projection"><label>Días para liquidar deuda:</label> <span id="proyDias">0 días</span></div>
    </section>

    <section class="card">
        <h2>Historial de Turnos</h2>

        <table class="tabla">
            <thead>
            <tr>
                <th>Fecha</th>
                <th>Horas</th>
                <th>Ganancia Bruta</th>
                <th>Gastos del Día</th>
                <th>Ganancia Neta</th>
            </tr>
            </thead>

            <tbody id="tablaTurnos"></tbody>
        </table>
    </section>
    
    <section class="card">
        <h2>Métricas Mensuales de Vehículo (Gasolina/KM)</h2>
        <div id="tablaKmMensual">
            </div>
    </section>

    <section class="card">
        <h2>Ganancias vs Gastos (Últimos 14 días)</h2>
        <canvas id="graficaGanancias"></canvas>
    </section>

    <section class="card">
        <h2>Kilometraje Diario (Últimos 14 días)</h2>
        <canvas id="graficaKm"></canvas>
    </section>
    
    <section class="card">
        <h2>Ajustes de Gastos Fijos (Para Proyección)</h2>

        <label>Deuda total (MXN):</label>
        <input type="number" id="proyDeudaTotal" readonly style="background:#eee;">

        <label>Gasto fijo diario (calculado):</label>
        <input type="number" id="proyGastoFijo" readonly style="background:#eee;">
        
        <hr>
        
        <h3>Ajustes Manuales</h3>
        
        <label>Costo asumido de Comida Diaria (MXN):</label>
        <input type="number" id="paramComidaDiaria">
        
        <label>Costo de Mantenimiento/Combustible por KM (MXN):</label>
        <input type="number" id="paramCostoPorKm">

        <button id="btnGuardarParametros" class="btn-primary">Guardar Ajustes</button>

        <p style="font-size: 0.9em; color: #555;">* Estos ajustes son usados en la fórmula para calcular el "Gasto fijo diario (calculado)".</p>
    </section>
    
    <section class="card">
        <h2>Importar / Exportar Datos</h2>

        <button id="btnExportar" class="btn-secondary">Exportar JSON (Copiar)</button>

        <button id="btnExportarExcel" class="btn-success">Exportar EXCEL (.xlsx)</button>

        <textarea id="importJson" placeholder="Pega tu JSON aquí"></textarea>
        <button id="btnImportar" class="btn-warning">Importar JSON</button>
    </section>

</main>

<script src="assets/js/app.js"></script>

</body>
</html>
