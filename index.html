<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Presupuesto Personal</title>
  <link rel="stylesheet" href="assets/css/style.css" />
  <style>
    .balance-card { background-color: #2ecc71; color: white; }
    .projection-results-card { border-left: 5px solid #3498db; }
    .top-actions { display:flex; justify-content:flex-end; margin-bottom:20px; }
    .admin-btn { padding:8px 15px; background:#3498db; color:white; border-radius:5px; }
    .tabla-listado th, .tabla-listado td { border:1px solid #ddd; padding:8px; text-align:left; }
    .valor-positivo { font-weight:bold; color:#27ae60; }
    .charts { display:flex; gap:1rem; flex-wrap:wrap; }
    .charts canvas { background:#fff; padding:0.5rem; border-radius:8px; box-shadow:0 1px 6px rgba(0,0,0,0.06); width:100%; max-width:600px; }
  </style>
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="container">
    <div class="top-actions">
        <button class="admin-btn" onclick="location.href='admin.html'">Administrar Datos âŸ¶</button>
    </div>

    <h1>ðŸ“Š Resumen Financiero</h1>

    <!-- BOTONES DE TURNO -->
    <div class="card" style="text-align:center;">
      <button id="btnIniciarTurno" onclick="iniciarTurno()" class="button" style="background:#27ae60;">
        â–¶ Iniciar Turno
      </button>

      <button id="btnFinalizarTurno" onclick="finalizarTurno()" class="button" style="background:#c0392b; display:none;">
        â–  Finalizar Turno
      </button>
    </div>

    <div class="card balance-card">
        <p>ðŸ’° Balance (Ingresos - Gasto Operacional)</p>
        <h2 id="balance">$0.00</h2>
    </div>

    <div class="card projection-results-card">
        <h2>ðŸ“ˆ Resultados de ProyecciÃ³n de Deuda (Basado en datos reales)</h2>

        <h3>Simulador RÃ¡pido</h3>
        <p>Ganancia Neta Potencial por DÃ­a: <strong id="simuladorGananciaDiariaNeto">$0.00</strong></p>
        <p>Pago Potencial a Deuda (en <strong id="diasRestantesSimulador">33</strong> dÃ­as): <strong id="simuladorPagoDeuda">$0.00</strong></p>

        <h3>Escenarios de Meta (Pagos Potenciales)</h3>
        <table id="tabla-proyeccion" class="tabla-listado">
            <thead>
                <tr><th>Escenario</th><th>Ganancia (Total)</th><th>Pago Deuda (Potencial)</th></tr>
            </thead>
            <tbody></tbody>
        </table>

        <h4>Progreso de LiquidaciÃ³n de Deuda ($<span id="deudaMetaTotal">19,793.00</span>)</h4>
        <div id="proyeccion-barras"></div>
    </div>

    <div class="card">
      <h2>ðŸ’¸ Ingresos y Gastos</h2>
      <p>Total Ingresos: <strong id="total-ingresos">$0.00</strong></p>
      <p>Total Gastos Operacionales: <strong id="total-gastos-neto">$0.00</strong></p>
      <p>Total Deuda Pendiente: <strong id="deudaTotalLabel">$0.00</strong></p>
    </div>

    <div class="card">
        <h2>ðŸš— Datos de Kilometraje</h2>
        <p>KM Recorridos Totales: <strong id="km-recorridos">0.00</strong> km</p>
        <p>Gasto Total Combustible: <strong id="km-gasto">$0.00</strong></p>
        <p>Rendimiento Promedio: <strong id="km-rendimiento">0.00</strong> km/L</p>
    </div>

    <!-- GRÃFICAS -->
    <div class="card">
      <h2>ðŸ“Š GrÃ¡ficas</h2>
      <div class="charts">
        <div style="flex:1;">
          <h3>Ingresos vs Gastos (Ãºltimos 14 dÃ­as)</h3>
          <canvas id="chartGanVsGas"></canvas>
        </div>
        <div style="flex:1;">
          <h3>Km recorridos vs Gasto gasolina (Ãºltimos repostajes)</h3>
          <canvas id="chartKmGas"></canvas>
        </div>
      </div>
    </div>

  </div>

  <script src="assets/js/app.js"></script>
  <script>
    window.addEventListener('load', () => {
      if (typeof onloadApp === 'function') onloadApp('index');
    });
  </script>
</body>
</html>
