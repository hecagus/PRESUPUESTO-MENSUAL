<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AdministraciÃ³n â€“ Uber Eats Tracker</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body data-page="admin">

<header class="header">
  <div class="logo">âš™ï¸ Admin</div>
  <button id="menuToggle" class="menu-toggle">â˜°</button>
  <nav id="navMenu" class="nav-menu">
    <a href="index.html">Dashboard</a>
    <a href="admin.html" class="active">Administrar</a>
    <a href="wallet.html">Wallet</a>
    <a href="historial.html">Historial</a>
  </nav>
</header>

<main class="container">

  <section class="card" id="cardTurnos">
    <h2>â±ï¸ GestiÃ³n de Turno</h2>
    <p id="turnoTexto" style="margin-bottom:10px;">ğŸ”´ Sin turno activo</p>
    
    <button id="btnIniciarTurno" class="btn-success" type="button" style="width:100%;">Iniciar Turno</button>
    <button id="btnFinalizarTurno" class="btn-danger" type=\"button\" style="display:none; width:100%;">Finalizar Turno</button>

    <div id="cierreTurnoContainer" style="display:none; margin-top:15px; padding-top:10px; border-top:1px solid #eee;">
        <label style="color:#dc2626; font-weight:bold;">Cierre de DÃ­a</label>
        
        <label>Ganancia Bruta (App + Propinas):</label>
        <input type="number" id="gananciaBruta" placeholder="$0.00" />
        
        <label>OdÃ³metro Final (KM):</label>
        <input type="number" id="kmFinalTurno" placeholder="Ej: 12500" />
        
        <div style="display:flex; gap:10px; margin-top:10px;">
            <button id="btnConfirmarFinalizar" class="btn-primary" type="button" style="flex:1;">Confirmar Cierre</button>
            <button id="btnCancelarCierre" class="btn-secondary" type="button" style="flex:1;">Cancelar</button>
        </div>
    </div>
  </section>

  <section class="card">
    <h2>ğŸ’° Registrar Ingreso Extra</h2>
    <input type="text" id="ingresoDescripcion" placeholder="DescripciÃ³n (ej. Bono, Regalo)" />
    <div style="display:flex; gap:10px; margin-top:5px;">
        <input type="number" id="ingresoCantidad" placeholder="$0.00" style="flex:1;" />
        <button id="btnRegistrarIngreso" class="btn-success" type="button" style="flex:1;">Guardar</button>
    </div>
  </section>

  <section class="card">
    <h2>ğŸ’¸ Registrar Gasto</h2>
    
    <div style="margin-bottom:10px;">
        <label><input type="radio" name="gastoTipoRadio" value="moto" checked> ğŸï¸ Moto</label>
        <label style="margin-left:15px;"><input type="radio" name="gastoTipoRadio" value="hogar"> ğŸ  Personal/Hogar</label>
    </div>

    <label>CategorÃ­a:</label>
    <select id="gastoCategoriaSelect"></select>
    <input type="text" id="gastoCategoriaManual" placeholder="Escribe la categorÃ­a..." style="display:none; margin-top:5px;" />

    <label style="margin-top:10px;">Monto ($):</label>
    <input type="number" id="gastoCantidad" placeholder="0.00" />

    <label>DescripciÃ³n (Opcional):</label>
    <input type="text" id="gastoDescripcion" placeholder="Detalles..." />
    
    <div style="margin:10px 0; background:#f8fafc; padding:10px; border-radius:5px;">
        <label style="display:flex; align-items:center; gap:8px; cursor:pointer;">
            <input type="checkbox" id="checkEsRecurrente">
            <span>ğŸ“… Es Gasto Fijo Mensual (Renta, Plan, etc)</span>
        </label>
        <select id="gastoFrecuenciaSelect" style="margin-top:5px;">
            <option value="Mensual">Mensual</option>
            <option value="Semanal">Semanal</option>
            <option value="Quincenal">Quincenal</option>
            <option value="Diario">Diario</option>
            <option value="Anual">Anual</option>
        </select>
    </div>

    <button id="btnRegistrarGasto" class="btn-danger" type="button" style="width:100%;">Registrar Gasto</button>
    
    <div style="margin-top:20px; border-top:1px solid #eee; padding-top:10px;">
        <h3>Gastos Fijos Activos:</h3>
        <ul id="listaGastosFijos" class="list"></ul>
        <p style="text-align:right; font-weight:bold; margin-top:5px;">Total Mensual: <span id="totalFijoMensualDisplay">$0.00</span></p>
    </div>
  </section>

  <section class="card">
    <h2>â›½ Registrar Gasolina (Wizard)</h2>
    
    <div id="gasWizardPaso1">
        <label>1. Â¿CuÃ¡ntos Litros cargaste?</label>
        <input type="number" id="gasLitros" placeholder="Ej: 12" />
        <button id="btnGasSiguiente1" class="btn-primary" type="button" style="margin-top:10px; width:100%;">Siguiente â¡</button>
    </div>

    <div id="gasWizardPaso2" style="display:none;">
        <label>2. Â¿CuÃ¡nto pagaste ($)?</label>
        <input type="number" id="gasCosto" placeholder="Ej: 240.00" />
        <div style="display:flex; gap:10px; margin-top:10px;">
            <button id="btnGasAtras2" class="btn-secondary" type="button" style="flex:1;">â¬… AtrÃ¡s</button>
            <button id="btnGasSiguiente2" class="btn-primary" type="button" style="flex:1;">Siguiente â¡</button>
        </div>
    </div>

    <div id="gasWizardPaso3" style="display:none;">
        <label>3. Kilometraje Actual (Opcional pero Recomendado)</label>
        <input type="number" id="gasKmActual" placeholder="OdÃ³metro actual" />
        <div style="display:flex; gap:10px; margin-top:10px;">
            <button id="btnGasAtras3" class="btn-secondary" type="button" style="flex:1;">â¬… AtrÃ¡s</button>
            <button id="btnRegistrarCargaFinal" class="btn-success" type="button" style="flex:1;">ğŸ’¾ Guardar Carga</button>
        </div>
    </div>
  </section>

  <section class="card">
    <h2>ğŸ› ï¸ Mantenimiento</h2>
    
    <div id="mantenimientoAlerta" style="padding:10px; border-radius:5px; margin-bottom:15px; font-weight:bold; font-size:0.9rem;">
        Estado: Calculando...
    </div>

    <h3>ConfiguraciÃ³n (Cada cuÃ¡ntos km):</h3>
    <div class="grid-2">
        <div><label>Aceite:</label><input type="number" id="mantenimientoAceite" /></div>
        <div><label>BujÃ­a:</label><input type="number" id="mantenimientoBujia" /></div>
        <div><label>Llantas:</label><input type="number" id="mantenimientoLlantas" /></div>
    </div>
    <button id="btnGuardarMantenimiento" class="btn-secondary" type="button" style="margin-top:10px; width:100%;">Guardar ConfiguraciÃ³n</button>

    <h3 style="margin-top:20px;">Registrar Servicio Realizado (KM Actual):</h3>
    <div class="grid-2">
        <div><label>Aceite:</label><input type="number" id="ultimoAceiteKM" placeholder="KM al cambio" /></div>
        <div><label>BujÃ­a:</label><input type="number" id="ultimoBujiaKM" placeholder="KM al cambio" /></div>
        <div><label>Llantas:</label><input type="number" id="ultimoLlantasKM" placeholder="KM al cambio" /></div>
    </div>
    <button id="btnRegistrarServicio" class="btn-primary" type="button" style="margin-top:10px; width:100%;">Actualizar Servicios</button>
  </section>

  <section class="card">
    <h2>ğŸï¸ Ajuste Manual OdÃ³metro</h2>
    <label>Kilometraje Actual:</label>
    <div style="display:flex; gap:10px;">
        <input type="number" id="inputOdometro" placeholder="Ej: 15000" style="flex:1;" />
        <button id="btnActualizarOdometro" class="btn-secondary" type="button">Actualizar</button>
    </div>
    <p style="margin-top:5px; color:#666;">Actual: <b id="kmActualDisplay">--- km</b> | Costo/KM: <b id="costoPorKmDisplay">---</b></p>
  </section>

  <section class="card">
    <h2>ğŸ’³ Obligaciones Financieras</h2>
    
    <div id="deudaWizardStep1">
        <label>Nombre de la Deuda:</label>
        <input type="text" id="deudaNombre" placeholder="Ej. Moto, Tarjeta..." />
        <button id="btnDeudaNext1" class="btn-primary" type="button" style="margin-top:10px; width:100%;">Siguiente</button>
    </div>
    
    <div id="deudaWizardStep2" style="display:none;">
        <label>Monto Total a Pagar:</label>
        <input type="number" id="deudaMontoTotal" placeholder="$" />
        <div style="display:flex; gap:10px; margin-top:10px;">
            <button id="btnDeudaBack2" class="btn-secondary" type="button" style="flex:1;">AtrÃ¡s</button>
            <button id="btnDeudaNext2" class="btn-primary" type="button" style="flex:1;">Siguiente</button>
        </div>
    </div>

    <div id="deudaWizardStep3" style="display:none;">
        <label>Cuota (Abono) y Frecuencia:</label>
        <input type="number" id="deudaMontoCuota" placeholder="$ por pago" />
        <select id="deudaFrecuencia" style="margin-top:5px;">
            <option value="Semanal">Semanal</option>
            <option value="Mensual">Mensual</option>
            <option value="Quincenal">Quincenal</option>
        </select>
        <div style="display:flex; gap:10px; margin-top:10px;">
            <button id="btnDeudaBack3" class="btn-secondary" type="button" style="flex:1;">AtrÃ¡s</button>
            <button id="btnRegistrarDeudaFinal" class="btn-success" type="button" style="flex:1;">Guardar Deuda</button>
        </div>
    </div>

    <hr style="margin:20px 0;" />
    
    <div>
        <h3>Registrar Abono</h3>
        <label>Seleccionar Deuda:</label>
        <select id="abonoSeleccionar" style="margin-bottom:5px;"></select>
        <div style="display:flex; gap:10px; margin-top:5px;">
            <input type="number" id="abonoMonto" placeholder="Monto ($)" style="flex:1;" />
            <button id="btnRegistrarAbono" class="btn-success" type="button" style="flex:1;">Abonar</button>
        </div>
    </div>

    <ul id="listaDeudas" class="list" style="margin-top:15px;"></ul>
    
    <hr style="margin:20px 0;" />
    
    <div style="background:#ecfdf5; padding:15px; border-radius:8px; border:1px solid #6ee7b7; text-align:center;">
        <h3>ğŸ¯ Meta Diaria Calculada</h3>
        <h1 id="metaDiariaDisplay" style="color:#059669; font-size:2rem; margin:10px 0;">$0.00</h1>
        <p class="nota">Calculado: (Gastos Fijos Diarios) + (Aporte Diaria a Deudas)</p>
    </div>
  </section>

  <section class="card">
    <h2>Respaldo</h2>
    <div style="display:flex; gap:10px;">
        <button id="btnCopiarJSON" class="btn-secondary" type="button" style="flex:1;">ğŸ“‹ Copiar Datos (JSON)</button>
        <button id="btnExportar" class="btn-secondary" type="button" style="flex:1;">ğŸ“Š Exportar Excel</button>
    </div>
    <div style="margin-top:10px; display:flex; gap:10px;">
         <input type="text" id="importJson" placeholder="Pegar JSON aquÃ­..." style="flex:1;" />
         <button id="btnImportar" class="btn-danger" type="button">Importar</button>
    </div>
  </section>

</main>
<script type="module" src="js/05_init.js"></script>
</body>
</html>
