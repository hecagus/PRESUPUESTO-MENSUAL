<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AdministraciÃ³n â€“ Tracker Modular</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body data-page="admin">

<header class="header">
  <h1>Panel Administrativo</h1>
  <div class="header-actions">
    <a href="index.html" class="btn-admin" id="adminButton" type="button">â¬… Volver al Panel</a>
  </div>
</header>

<main class="container">

  <section class="card" id="cardTurnos">
    <h2>â±ï¸ GestiÃ³n de Turno</h2>
    <p id="turnoTexto" style="margin-bottom:10px; font-size: 1.1rem;">ğŸ”´ Sin turno activo</p>
    
    <button id="btnIniciarTurno" class="btn-success" type="button" style="width:100%;">Iniciar Turno</button>
    <button id="btnPreFinalizarTurno" class="btn-danger" type="button" style="display:none; width:100%;">Finalizar Turno</button>

    <div id="cierreTurnoContainer" style="display:none; margin-top:15px; padding:15px; background:#fff5f5; border:1px solid #fca5a5; border-radius:8px;">
        <label style="color:#dc2626; font-weight:bold;">ğŸ’° Cierre de Caja (Dinero):</label>
        <p class="nota">Ingresa tu ganancia total del dÃ­a (Apps + Propinas).</p>
        <input type="number" id="gananciaBruta" placeholder="$ 0.00" />
        
        <div style="display:flex; gap:10px; margin-top:10px;">
            <button id="btnCancelarCierre" class="btn-secondary" type="button" style="flex:1;">Cancelar</button>
            <button id="btnConfirmarFinalizar" class="btn-danger" type="button" style="flex:1;">Confirmar Fin</button>
        </div>
    </div>
  </section>

  <section class="card">
    <h2>ğŸï¸ Control de OdÃ³metro (KM)</h2>
    <p class="nota">Actualiza tu kilometraje independientemente de los turnos.</p>
    
    <div style="display: flex; justify-content: space-between; margin-bottom: 15px; background: #f3f4f6; padding: 10px; border-radius: 6px;">
        <div>
            <label style="margin:0; font-size:0.8rem;">KM Registrado:</label>
            <strong id="lblKmAnterior" style="font-size:1.2rem;">0</strong>
        </div>
        <div>
            <label style="margin:0; font-size:0.8rem;">Estado:</label>
            <span id="lblEstadoOdometro" style="color:green; font-weight:bold;">OK</span>
        </div>
    </div>

    <label>Actualizar Lectura:</label>
    <div style="display:flex; gap:10px;">
        <input type="number" id="inputOdometro" placeholder="Ej. 15200" style="flex:2;" />
        <button id="btnActualizarOdometro" class="btn-primary" type="button" style="flex:1;">Actualizar</button>
    </div>
  </section>

  <section class="card">
    <h2>â• Ingreso Extra</h2>
    <div style="display:flex; gap:10px;">
        <input type="text" id="ingresoDescripcion" placeholder="Desc. (Ej. Propina)" style="flex:2;" />
        <input type="number" id="ingresoCantidad" placeholder="$0.00" style="flex:1;" />
    </div>
    <button id="btnRegistrarIngreso" class="btn-secondary" type="button" style="width:100%; margin-top:10px;">Registrar</button>
  </section>

  <section class="card">
    <h2>ğŸ’¸ Registrar Gasto Inteligente</h2>
    
    <div style="display:flex; gap:15px; margin-bottom:15px; font-weight:bold; background:#f3f4f6; padding:10px; border-radius:8px;">
        <label style="cursor:pointer; display:flex; align-items:center; gap:5px;">
            <input type="radio" name="gastoTipoRadio" value="moto" checked> ğŸï¸ Moto (Operativo)
        </label>
        <label style="cursor:pointer; display:flex; align-items:center; gap:5px;">
            <input type="radio" name="gastoTipoRadio" value="hogar"> ğŸ  Hogar (Personal)
        </label>
    </div>

    <label>CategorÃ­a:</label>
    <select id="gastoCategoriaSelect" style="width:100%; padding:10px; margin-bottom:10px; border:1px solid #ccc; border-radius:5px; background:white;">
        </select>
    
    <input type="text" id="gastoCategoriaManual" placeholder="âœï¸ Escribe el nombre del nuevo gasto..." style="display:none; margin-bottom:10px; border:2px solid #2563eb; background:#eff6ff;" />

    <div style="display:flex; gap:10px;">
        <div style="flex:1;">
            <label>Monto ($):</label>
            <input type="number" id="gastoCantidad" placeholder="0.00" />
        </div>
        <div style="flex:2;">
            <label>DescripciÃ³n (Opcional):</label>
            <input type="text" id="gastoDescripcion" placeholder="Detalle extra..." />
        </div>
    </div>

    <div style="margin:15px 0; padding:15px; border:1px solid #ddd; border-radius:8px;">
        <label style="display:flex; align-items:center; gap:10px; font-weight:bold; cursor:pointer;">
            <input type="checkbox" id="checkEsRecurrente" style="transform:scale(1.5);">
            Â¿Es un Gasto Fijo / Recurrente?
        </label>
        <p class="nota" style="margin-left:28px; margin-bottom:10px;">(Ej. Renta, Luz, Suscripciones). Si lo marcas, se sumarÃ¡ a tu Meta Diaria.</p>

        <div id="divFrecuenciaGasto" style="display:none; margin-left:28px; border-top:1px solid #eee; padding-top:10px;">
            <label style="color:#2563eb; font-weight:bold;">ğŸ“… Â¿Cada cuÃ¡ndo se paga?</label>
            <select id="gastoFrecuenciaSelect" style="width:100%; padding:8px;">
                <option value="Semanal">Semanal</option>
                <option value="Quincenal">Quincenal</option>
                <option value="Mensual" selected>Mensual</option>
                <option value="Bimestral">Bimestral (Luz)</option>
                <option value="Anual">Anual</option>
            </select>
        </div>
    </div>

    <button id="btnRegistrarGasto" class="btn-danger" type="button" style="width:100%; padding:10px;">ğŸ’¾ Guardar Gasto</button>
  </section>

  <section class="card">
    <h2>â›½ Carga de Combustible</h2>
    <div class="projection-grid" style="margin-bottom: 10px;">
        <div class="projection"><label>Costo/KM:</label><span id="costoPorKmDisplay">$0.00</span></div>
    </div>
    
    <div id="gasWizardPaso1">
        <label>1. Litros:</label>
        <input type="number" id="gasLitros" placeholder="0.00" />
        <button id="btnGasSiguiente1" class="btn-primary" type="button" style="width:100%; margin-top:5px;">Siguiente â¡</button>
    </div>
    <div id="gasWizardPaso2" style="display:none;">
        <label>2. Costo Total ($):</label>
        <input type="number" id="gasCosto" placeholder="$0.00" />
        <div style="display:flex; gap:5px; margin-top:5px;">
            <button id="btnGasAtras2" class="btn-secondary" type="button" style="flex:1;">â¬…</button>
            <button id="btnGasSiguiente2" class="btn-primary" type="button" style="flex:1;">Siguiente â¡</button>
        </div>
    </div>
    <div id="gasWizardPaso3" style="display:none;">
        <label>3. KM al cargar:</label>
        <input type="number" id="gasKmActual" placeholder="OdÃ³metro" />
        <div style="display:flex; gap:5px; margin-top:5px;">
             <button id="btnGasAtras3" class="btn-secondary" type="button" style="flex:1;">â¬…</button>
             <button id="btnRegistrarCargaFinal" class="btn-success" type="button" style="flex:1;">Guardar</button>
        </div>
    </div>
  </section>

  <section class="card">
    <h2>ğŸ”§ Mantenimiento</h2>
    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
        <div><label>Aceite (KM):</label><input type="number" id="mantenimientoAceite" /></div>
        <div><label>BujÃ­a (KM):</label><input type="number" id="mantenimientoBujia" /></div>
        <div style="grid-column: span 2;"><label>Llantas (KM):</label><input type="number" id="mantenimientoLlantas" /></div>
    </div>
    <button id="btnGuardarMantenimiento" class="btn-secondary" type="button" style="width:100%;">Guardar Config</button>
  </section>

  <section class="card">
    <h2>ğŸ“‰ Deudas y Metas</h2>
    <div id="deudaWizardStep1">
      <label>1. Nombre de la Deuda:</label>
      <input type="text" id="deudaNombre" placeholder="Ej. Moto" />
      <button id="btnDeudaNext1" class="btn-primary" type="button" style="width:100%; margin-top:10px;">Siguiente â¡</button>
    </div>
    <div id="deudaWizardStep2" style="display:none;">
      <label>2. Total a Pagar ($):</label>
      <input type="number" id="deudaMontoTotal" placeholder="15000" />
      <label>3. Cuota Regular ($):</label>
      <input type="number" id="deudaMontoCuota" placeholder="100" />
      <div style="display:flex; gap:10px; margin-top:10px;">
          <button id="btnDeudaBack2" class="btn-secondary" type="button" style="flex:1;">â¬…</button>
          <button id="btnDeudaNext2" class="btn-primary" type="button" style="flex:1;">Siguiente â¡</button>
      </div>
    </div>
    <div id="deudaWizardStep3" style="display:none;">
      <label>4. Frecuencia:</label>
      <select id="deudaFrecuencia">
        <option value="Semanal">Semanal</option>
        <option value="Mensual">Mensual</option>
        <option value="Diario">Diario</option>
      </select>
      <div style="display:flex; gap:10px; margin-top:10px;">
          <button id="btnDeudaBack3" class="btn-secondary" type="button" style="flex:1;">â¬…</button>
          <button id="btnRegistrarDeudaFinal" class="btn-success" type="button" style="flex:1;">Registrar</button>
      </div>
    </div>
    <hr style="margin:20px 0;" />
    
    <div style="background:#ecfdf5; padding:15px; border-radius:8px; border:1px solid #6ee7b7; text-align:center;">
        <h3>ğŸ¯ Meta Diaria Calculada</h3>
        <h1 id="metaDiariaDisplay" style="color:#059669; font-size:2rem; margin:10px 0;">$0.00</h1>
        <p class="nota">Calculado: (Gastos Fijos Diarios) + (Aporte Diaria a Deudas)</p>
    </div>
  </section>

  <section class="card">
    <h2>ğŸ’¾ Respaldo y Datos</h2>
    <p class="nota">Guarda una copia de tus datos o impÃ³rtalos en otro dispositivo.</p>
    
    <div style="display:flex; gap:10px; margin-bottom:15px;">
        <button id="btnExportarJSON" class="btn-secondary" type="button" style="flex:1;">ğŸ“‹ Copiar JSON</button>
        <button id="btnExportarExcel" class="btn-success" type="button" style="flex:1;">ğŸ“Š Bajar Excel</button>
    </div>

    <hr style="margin:10px 0; border:0; border-top:1px dashed #ccc;" />

    <label>Restaurar datos (Pegar JSON):</label>
    <textarea id="importJsonArea" rows="2" placeholder='Pega aquÃ­ el cÃ³digo JSON...' style="width:100%; border:1px solid #ccc; border-radius:5px; padding:5px;"></textarea>
    <button id="btnImportarJSON" class="btn-danger" type="button" style="width:100%; margin-top:10px;">âš ï¸ Restaurar Datos</button>
  </section>

</main>
<script type="module" src="js/05_init.js"></script>
</body>
</html>
